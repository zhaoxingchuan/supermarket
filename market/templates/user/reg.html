{% extends "public/reg-log-forget.html" %}
{% load static %}
{% block head_js %}
    <script src="{% static 'js/time.js' %}"></script>
{% endblock %}
{% block title %}
    注册
{% endblock %}
{% block content %}
    <div style="height: 3rem;"></div>
    <form action="" method="post">
        {% csrf_token %}
        <input type="text" name="phone" placeholder="请输入手机号" value="{{ phone }}" class="login-name">
        <p class="am-text-danger">{{ errors.phone.0 }}</p>
        <input type="password" name="password1" placeholder="请输入密码" class="login-password">
        <p class="am-text-danger">{{ errors.password1.0 }}</p>
        <input type="password" name="password2" placeholder="确认密码" class="login-name">
        <p class="am-text-danger">{{ errors.password2.0 }}</p>
        <div class="yzm" style="margin-top: 1.5rem;">
            <input type="text" class="reg-yzm" placeholder="输入验证码"/>
            <input type="button" class="yzm-hq" value="获取验证码"/>
        </div>
        <input type="submit" class="login-btn" value="立即注册">
    </form>
    <div class="agree">
        <input type="checkbox" name="checkbox" value="同意" checked="">&nbsp;同意
        <a href="" class="xy">《用户协议》</a>
        <div class="r-login">已有账号，请<a href="{% url 'user:login' %}" class="l-login">登录</a></div>
    </div>
{% endblock %}
{% block footer_js %}
    <script>
        $(function () {
            {#绑定获取验证码的点击事件#}
            $(".yzm-hq").on("click", function () {
                {#console.debug(111)#}
                {#获取手机号码的值#}
                var phone = $("input[name='phone']").val();
                {#验证手机号码的格式#}
                var reg = /^1[3-9]\d{9}$/;
                if (!reg.test(phone)) {
                    alert("手机号码格式错误");
                    return;
                }
                {#发送ajax到后台进行验证#}
                $.ajax({
                    type: "post",
                    url: "{% url 'user:sendMsg' %}",
                    data: {"phone": phone, 'csrfmiddlewaretoken': "{{ csrf_token }}"},
                    dataType: "json",
                    success: function (data) {
                        console.debug(data)
                    }
                })
            })
        })
    </script>
{% endblock %}

